# 出勤時間予測Webアプリ
過去のデータから出勤時間を予測します．
また，オンライン学習を導入しています．
無料のホスティングサービスでのデプロイを念頭においた軽量化のためです．
リアルタイムにモデルの更新を行うため，利用を経るごとに予測精度の改善が期待できます．
予測には多項式回帰モデルを用いています．
誤差には2乗和誤差を，パラメタ更新には確率的勾配降下法を用いています．
フロントエンドにはLINE Botを利用します．


## 事前学習（ローカル学習）
`local_data.json`を用意します．
書式は次の通りです：
```markdown
[
  {
    "user_id": <str>,
    "commuting_data": [
      {
        "departure_time": <hhmmss>,
        "minutes_required": <hhmmss>
      },
      ...
    ],
    "returning_data": [
      {
        "departure_time": <hhmmss>,
        "minutes_required": <hhmmss>
      },
      ...
    ]
  },
  ...
]
```
手元の環境で`$ python commuter/local_train.py --local`を叩いてください（未実装）．
`commuter/weights.json`が更新されます．


## 利用（オンライン学習）
LINE Botを利用するための準備が必要です．
また，ホスティング用サーバも用意する必要があります．
デプロイ時には事前学習で使用した`local_data.json`は必要ないです．

ユーザはLINE Botとのやり取りを通じて本システムを利用します．
「出勤」を含むメッセージが送信されると，
送信者に対応するモデルが選択され，送信時刻を入力とした出勤時間の予測を行います．
予測時間はLINE Botにより通知されます．
「出勤」を送信してから90分以内に「到着」を含むメッセージが送信されると，
「出勤」の送信から「到着」の送信までの時間を出勤時間とし，モデルの更新を行います．
`commuter/weights.json`に更新後のパラメタが記録されます．
